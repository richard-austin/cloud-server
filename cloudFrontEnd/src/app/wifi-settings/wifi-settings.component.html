<div class="wifi-settings-container">
  <mat-card>
    <mat-card-title>Wifi Settings</mat-card-title>
    <mat-card-content>
      <div class="alert-warning-embedded" *ngIf="ethernetConnectionStatus == 'NOT_CONNECTED_VIA_ETHERNET'"
        [innerHTML]="'You have an Ethernet connection, but your NVR is connected to the Cloud service through Wi-Fi. To disable Wi-Fi, the NVR must be connected through Ethernet. You can still select another Wi-Fi access point. <br><br>To switch the connection to ethernet, click the Reset Connection button, then wait until display shows the current Wi-Fi status again.'">
      </div>

      <div class="alert-warning-embedded" *ngIf="ethernetConnectionStatus == 'NO_ETHERNET'"
           [innerHTML]="'You have no Ethernet connection available, To disable Wi-Fi, the NVR must be connected through Ethernet. You can still select another Wi-Fi access point. <br><br>To switch the connection to Ethernet, connect an Ethernet cable between your router and the NVR then click the Reset Connection button, then wait until display shows the current Wi-Fi status again.'">
      </div>
      <div class="reset-connection-button connecting-spinner">
        <button *ngIf="ethernetConnectionStatus != 'CONNECTED_VIA_ETHERNET' && ethernetConnectionStatus != ''"
                [disabled]="resetting"
                color="warning" mat-flat-button
                (click)="resetConnection()">Reset Connection
        </button>
        <ng-container *ngIf="resetting">

            <mat-spinner [diameter]="25"></mat-spinner>
            Restarting Cloud Proxy
        </ng-container>
      </div>
      <app-reporting [embedded]="true"></app-reporting>
      <mat-checkbox [color]="'primary'" [checked]="wifiEnabled"
                    #wifiStatusCheckbox
                    matTooltip="Wi-Fi is currently {{wifiEnabled ? 'enabled' : 'disabled'}}, click to {{wifiEnabled ? 'disable' : 'enable'}}"
                    matTooltipClass="tooltip"
                    [disabled]="ethernetConnectionStatus != 'CONNECTED_VIA_ETHERNET'"
                    (change)="setWifiStatus($event)">
        {{wifiEnabled ? 'Disable' : 'Enable'}} Wi-Fi
      </mat-checkbox>
      <div>
        <mat-form-field appearance="fill">
          <mat-label *ngIf="!loading">
            {{wifiEnabled ? 'Select Wi-Fi Access Point' : 'Wi-Fi Is Off'}}
          </mat-label>
          <mat-label *ngIf="loading">
            <div class="connecting-spinner">
              <mat-spinner [diameter]="25"></mat-spinner>
              Loading..
            </div>
          </mat-label>
          <mat-select [disabled]="!wifiEnabled"
                      (selectionChange)="onSelectorChange()"
                      #selector>
            <mat-option *ngFor="let wifi of wifiList" [value]="wifi.ssid">
              {{wifi.ssid}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div *ngIf="needPassword">
        <mat-form-field class="password-field" appearance="fill">
          <input matInput type="password" [formControl]="getFormControl(enterPasswordForm, 'password')"
                 matTooltip="Enter password for {{selector.value}}"
                 matTooltipClass="tooltip"
                 placeholder="Password for {{selector.value}}">
          <mat-hint>New password for {{selector.value}}</mat-hint>
        </mat-form-field>
      </div>
      <div class="connecting-spinner">
        <button [disabled]="!wifiEnabled || currentWifiConnection.accessPoint == selector.value || connecting"
                mat-flat-button
                color="warn"
                (click)="connect()">Connect
        </button>
        <ng-container *ngIf="connecting">
          <span class="connecting-spinner">
            <mat-spinner [diameter]="25"></mat-spinner>
            Connecting to {{selector.value}}
          </span>
        </ng-container>
      </div>
    </mat-card-content>
  </mat-card>
</div>
